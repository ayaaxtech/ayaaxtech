<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Ayaax AI</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #chat { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: auto; margin-bottom: 10px; }
    input { width: 70%; padding: 5px; }
    button { padding: 5px 10px; }
    p { margin: 5px 0; }
  </style>
</head>
<body>

<h2>Ayaax AI</h2>

<div id="chat"></div>

<input id="msg" placeholder="Type message">
<button id="sendBtn">Send</button>

<script type="module">
// Use module so browser can handle modern JS
const sendBtn = document.getElementById('sendBtn');
const input = document.getElementById('msg');
const chat = document.getElementById('chat');

sendBtn.addEventListener('click', async () => {
  const message = input.value.trim();
  if (!message) return;

  chat.innerHTML += `<p><b>You:</b> ${message}</p>`;
  input.value = '';
  chat.scrollTop = chat.scrollHeight;

  try {
    const res = await fetch('/.netlify/functions/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message })
    });

    const data = await res.json();
    chat.innerHTML += `<p><b>AI:</b> ${data.reply || 'No response'}</p>`;
    chat.scrollTop = chat.scrollHeight;
  } catch (err) {
    console.error(err);
    chat.innerHTML += `<p style="color:red;"><b>Error:</b> Could not contact AI server.</p>`;
    chat.scrollTop = chat.scrollHeight;
  }
});

// Optional: allow Enter key to send
input.addEventListener('keydown', (e) => {
  if (e.key === 'Enter') sendBtn.click();
});
</script>

</body>
</html>
